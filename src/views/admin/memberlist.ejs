<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="/static/js/admin/memberlist.js" defer></script>
    <!-- 아이콘 및 폰트 링크 -->
    <link rel="icon" href="/static/front_image/dotoree.png" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bungee&family=Russo+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Bungee&family=Nanum+Gothic&family=Russo+One&display=swap"
        rel="stylesheet">
    <!-- front.css 추가 (헤더 등 공통 스타일을 위한 링크) -->
    <link rel="stylesheet" href="/static/css/front/front.css">
</head>
</head>
<script>
    // EJS에서 전달된 'thema'와 'menu' 변수 값을 JavaScript 변수로 설정
    var thema = "<%= thema %>";  // EJS에서 전달한 thema 값을 JavaScript 변수로 설정

    // 브라우저 콘솔에서 thema와 menu 값을 확인
    console.log(thema);

    // 페이지가 로드될 때 실행되는 함수 (window.onload)
    window.onload = async () => {

        // 페이지에 테마를 적용하는 함수 호출
        applyThema(thema);
    }

    // 페이지 이동 시 새로운 데이터를 동적으로 불러오는 함수
    async function loadPage(start) {
        try {
            const res = await fetch(`/admin/member?start=${start}`);
            const html = await res.text();  // 받아온 HTML을 텍스트로 처리
            document.getElementById('main_section').innerHTML = html;  // 받아온 HTML을 페이지에 삽입
        } catch (error) {
            console.error('Error fetching data:', error);
        }
    }

</script>
</head>


<body class="front_body">

    <%- include('../include/header.ejs') %>
        <!-- 아이디 찾기 폼 -->
        <section id="memberlist">
            <table border="1">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>이름</th>
                        <th>이메일</th>
                        <th>주소</th>
                        <th>전화번호</th>
                        <th>탈퇴</th> <!-- 탈퇴 버튼을 추가 -->
                    </tr>
                </thead>
                <tbody>
                    <% data.forEach(d=> { %>
                        <tr>
                            <td>
                                <%= d.ID %>
                            </td>
                            <td>
                                <%= d.NAME %>
                            </td>
                            <td>
                                <%= d.EMAIL %>
                            </td>
                            <td>
                                <%= d.ADDR %>
                            </td>
                            <td>
                                <%= d.PHONE %>
                            </td>
                            <td>
                                <!-- 탈퇴 링크를 <a> 태그로 추가 -->
                                <a href="javascript:void(0);" onclick="deleteMember('<%= d.ID %>');">탈퇴</a>
                            </td>
                        </tr>
                        <% }) %>
                </tbody>
            </table>

            <!-- 페이지 이동 처리 -->
            <table class="board_page">
                <tr>
                    <td class="board_button">
                        <% if (start <=1) { %>
                            <button disabled>이전</button> |
                            <% } else { %>
                                <button type="button" onclick="loadPage('<%= start - 1 %>')">이전</button> |
                                <% } for (let i=1; i <=page; i++) { %>
                                    <a href="javascript:void(0);" onclick="loadPage('<%= i %>')">
                                        <%= i %>
                                    </a>
                                    <% } if (start < page) { %>
                                        | <button type="button" onclick="loadPage('<%= start + 1 %>')">다음</button>
                                        <% } else { %>
                                            | <button disabled>다음</button>
                                            <% } %>
                    </td>
                    <a class="board_new" href="/board/write_form">글쓰기</a>
                </tr>
            </table>
        </section>

        <%- include('../include/footer.ejs') %>

</body>

</html>